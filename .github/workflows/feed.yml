name: KuCoin SOLayerÂ SuperÂ Feed

on:
  #Â Update elke 15Â min, start op minuutÂ 01 zodat candles gesloten zijn
  schedule:
    - cron: '1/15 * * * *'
  workflow_dispatch:

concurrency:
  group: kucoin-solayer-super-feed
  cancel-in-progress: true

jobs:
  push-feed:
    runs-on: ubuntu-latest

    steps:
    #Â 1Â â€“Â Repo klonen
    - uses: actions/checkout@v4

    #Â 2Â â€“Â Python 3.11 klaarzetten
    - uses: actions/setup-python@v5
      with:
        python-version: '3.11'

    #Â 3Â â€“Â pipâ€‘cache (sneller)
    - name: Cache pip downloads
      uses: actions/cache@v4
      with:
        path: ~/.cache/pip
        key: ${{ runner.os }}-pip-${{ hashFiles('requirements.txt') }}
        restore-keys: |
          ${{ runner.os }}-pip-

    #Â 4Â â€“Â Dependencies installeren
    - name: Install Python dependencies
      run: |
        python -m pip install --upgrade pip
        if [ -s requirements.txt ]; then
          pip install --no-cache-dir -r requirements.txt
        else
          pip install --no-cache-dir pandas pandas_ta ta requests numpy
        fi

    #Â 5Â â€“Â Feed genereren & Gist bijwerken
    - name: Build & push SOLayer superâ€‘feed
      env:
        #Â ğŸ”Â Verplichte secrets
        GIST_TOKEN:  ${{ secrets.GIST_TOKEN }}
        GIST_ID:     ${{ secrets.GIST_ID }}

        #Â ğŸ“ŠÂ Feedâ€‘parameters
        ENDPOINT:    futures            #Â 'spot' of 'futures'
        SYMBOL:      SOLAYERUSDTM
        TIMEFRAMES:  "1m,5m,15,60,240,D"  #Â Wordt door het script geparsed
        FILE_NAME:   solayer_superfeed.json
      run: python kucoin_solayer_feed.py
